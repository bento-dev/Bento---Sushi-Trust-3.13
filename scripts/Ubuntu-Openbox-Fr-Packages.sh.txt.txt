#!/bin/bash

#####################################################################################################
# Install script to add to Ubuntu Mini Remix - http://www.ubuntu-mini-remix.org -					#
# in order to get a Ubuntu Openbox Remix   								    						#
# More informations from a script where I started to pick ideas:									#
# http://bazaar.launchpad.net/~lubuntu-desktop/+junk/lubuntu-tools/view/head:/iso/lubuntu-build.sh	#
#####################################################################################################


## Add repositories

# We might need to have add-apt-repository (or not)
# apt-get -q -y install python-software-properties

# Meets 
echo "deb http://ppa.launchpad.net/meets/ppa/ubuntu `lsb_release -cs` main #openbox-menu" | tee -a /etc/apt/sources.list.d/meets.list
apt-key adv --recv-keys --keyserver keyserver.ubuntu.com C84C67E9

# Tiheum
echo "deb http://ppa.launchpad.net/tiheum/equinox/ubuntu `lsb_release -cs` main #faenza-icon-theme" | tee -a /etc/apt/sources.list.d/tiheum.list
apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 4631BBEA

# danielrichter2007
echo "deb http://ppa.launchpad.net/danielrichter2007/grub-customizer/ubuntu `lsb_release -cs` main #grub-customizer" | tee -a /etc/apt/sources.list.d/danielrichter.list
apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 3F055C03

# Medibuntu
wget http://www.medibuntu.org/sources.list.d/`lsb_release -cs`.list --output-document=/etc/apt/sources.list.d/medibuntu.list
apt-get -q update
apt-get --yes -q --allow-unauthenticated install medibuntu-keyring

## Updates and installs
# Update in-chroot package database
apt-get -q update && apt-get -q dist-upgrade

# Install French language packs
apt-get -q -y install wfrench firefox-locale-fr language-pack-fr language-pack-fr-base language-pack-gnome-fr language-pack-gnome-fr-base

# Install core packages //ones not yet installed into Ubuntu Mini Remix
apt-get -q -y --purge install laptop-detect

# Install Xorg / xserver for the graphical environment
apt-get -q -y install xorg gcc-4.6-locales libglide3 mesa-utils xfonts-100dpi xfonts-75dpi  xfonts-scalable gcc-4.6 x11-utils

# Install driver and device to setup the touchpad on laptops - and laptop related
apt-get -q -y install xserver-xorg-input-synaptics xserver-xorg-input-mtrack gpointing-device-settings laptop-mode-tools

# Install graphical package manager
apt-get -q -y install synaptic aptdaemon ## option for the time being : update-notifier

# Install a few more packages for the system
apt-get -q -y install xdg-user-dirs xdg-user-dirs-gtk upower policykit-1-gnome policykit-desktop-privileges libpam-ck-connector

# Install a session manager
apt-get -q -y install lightdm lightdm-gtk-greeter mythbuntu-lightdm-theme ## changing mythbuntu-lightdm-theme background for our use for the time being

# Install plymouth along with a theme
apt-get -q -y install plymouth plymouth-label plymouth-theme-solar plymouth-theme-text 

# Install packages for the Openbox environment setup
apt-get -q -y install openbox openbox-menu sakura obconf obmenu hsetroot xcompmgr xsnow feh tint2 pcmanfm lxappearance lxshortcut lxsession-edit lxrandr libjpeg-progs python-xdg 

# Install configuration files for Openbox along with openbox-menu, tint2 and a bit more
# we should be located in the / directory, therefore extracting the tarball should copy it's content to the right place
wget http://meets.free.fr/debian/Configurations/etcskel.tar.bz2 ; tar xfvj etcskel.tar.bz2 ; rm -f etcskel.tar.bz2

# Install obsession from mimas development webspace - while it is not yet packaged for Ubuntu
# I will probably copy a binary ready to use
# http://code.google.com/p/mimarchlinux/

# Install packages for the look and feel in the desktop
apt-get -q -y install gtk2-engines gtk2-engines-murrine murrine-themes hicolor-icon-theme gnome-icon-theme gnome-icon-theme-full faenza-icon-theme xcursor-themes 
## faenza-cupertino icon-theme recolored from tiheum's faenza-icon-theme
wget -c http://gnome-look.org/CONTENT/content-files/129008-Faenza-Cupertino.tar.gz ; tar xvfz 129008-Faenza-Cupertino.tar.gz ; mkdir -p /etc/skel/.icons ; mv Faenza-Cupertino /etc/skel/.icons ; rm 129008-Faenza-Cupertino.tar.gz

# Install system and hardware related packages 
apt-get -q -y install acpid apmd sdparm ethtool wireless-tools wpasupplicant linux-firmware-nonfree firmware-b43-installer firmware-crystalhd hardinfo ## to be continued

# Packages for network
apt-get -q -y install network-manager network-manager-gnome tcpd tcpdump 
 
# Install drivers to test the distro in Virtualbox with possibly a good resolution
apt-get -q -y install virtualbox-guest-utils virtualbox-guest-x11

# Install alsa packages, gstreamer and such
apt-get -q -y install alsa-base alsa-oss alsa-tools alsa-utils gnome-alsamixer volumeicon-alsa gstreamer0.10-alsa gstreamer-tools gstreamer0.10-ffmpeg gstreamer0.10-plugins-base gstreamer0.10-plugins-bad gstreamer0.10-plugins-good gstreamer0.10-plugins-ugly gstreamer0.10-pulseaudio gstreamer0.10-tools gstreamer0.10-x libgstreamer-plugins-bad0.10-0 libgstreamer-plugins-base0.10-0 libgstreamer0.10-0 gir1.2-gstreamer-0.10

# A few small text mode utilities
apt-get -q -y install scrot irssi lftp testdisk foremost pastebinit htop mc wodim

# Some graphical applications
apt-get -q -y install glib-networking midori xchat geany file-roller geeqie galculator epdfview

# Some sets of fonts
apt-get -q -y install fonts-droid fonts-liberation ttf-dejavu

# Packages for install time
apt-get -q -y install gparted ubiquity ubiquity-casper ubiquity-frontend-gtk ubiquity-ubuntu-artwork 

# Additional and for the time being, needed for ubiquity to look clean, with permission of Julien Lavergne - many thanks -
apt-get -q -y install ubiquity-slideshow-lubuntu

# List borrowed from Lubuntu - optional
# apt-get -q -y install lxkeymap lxinput jockey-gtk language-selector-gnome software-properties-gtk

# List borrowed from Lubuntu core - http://packages.ubuntu.com/precise/lubuntu-core
apt-get -q -y install anacron bc ca-certificates ghostscript-x inputattach nvidia-common ttf-freefont zip ## paquets à installer peut-être... à voir ??
# acpi-support avahi-daemon bluez bluez-alsa bluez-cups kerneloops-daemon libnss-mdns pcmciautils ttf-ubuntu-font-family

# some packages I want to have (need to be spread in categories as time comes)
apt-get -q -y install gksu gfxboot gfxboot-themes-upstream netplug grub-customizer libgtk2.0-bin librsvg2-common gvfs sshfs ssh ssh-import-id gnupg-agent gnupg2 openssl sound-theme-freedesktop p7zip-full unzip xfsprogs reiserfsprogs reiser4progs jfsutils ntfsprogs ntp rfkill usb-modeswitch xterm deborphan dialog desktop-file-utils gvfs-backends gvfs-fuse pm-utils apport-gtk blueman ibus linux-headers-generic

# ZRAM
apt-get -q -y install zram-config ## / Ne pas oublier de configurer le fichier quivabien pour avoir zram dans le live - un fichier est sous squashfs-root/usr/share/initramfs-tools/conf.d avec un fichier "compcache" et l'autre dans quashfs-root/etc/initramfs-tools/initramfs.conf 

## configurations - quelques scripts de plus à faire
# script pour créer /usr/share/initramfs-tools/scripts/casper-bottom/26desktop-launchers selon le modèle fourni par "frafra"
# penser à vérifier tous les fichiers de thème et les reprendre depuis la version précédente:
# gfxboot
# plymouth
# lightdm
# fond du bureau 
# theme Openbox

# ==> préparer un tarball avec une arborescence de fichiers pour ces divers fichiers à ajouter juste après l'installation des programmes.

# préparer de même un tarball avec le binaire de obsession, le readme, auteur etc... pour ajouter au répertoire /usr/local/*

# Dés que la préparation des divers fichiers de thème sera prête et en ligne, recommencer à nouveau depuis le début pour repartir à nouveau sur une base propre : penser à supprimer le vieux kernel après la mise à jour... une ligne de script serait aussi bienvenue pour cela. 

# Vérifier aussi dans Synaptic les éventuels résidus de configuration



